<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Ensemble learning survival prediction with improved interface. â€¢ OncoCast</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="Ensemble learning survival prediction with improved interface.">
<meta property="og:description" content="OncoCast is an ensemble learner relying on cross-validation for high dimensional survival data. The algorithm can handle left truncated (delayed entry) data for all available methods. Multiple regression methods can be used including LASSO, elastic-net or generalized boosted regression.
    Originally developed to stratify cancer patients based on their genomic profile. Through cross-validation we generate an average predictive risk score that acts as a surrogate for the aggregated effects of the profile of each patients. We include an interactive R based application that enables the user to explore the results in various ways. More details can be found in the vignette included in the package.">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">OncoCast</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="articles/Ensemble-Learner.html">Ensemble-Learner</a>
    </li>
    <li>
      <a href="articles/OncoCast-Data.html">OncoCast-Data</a>
    </li>
    <li>
      <a href="articles/Online-Tools.html">Online-Tools</a>
    </li>
    <li>
      <a href="articles/Risk-Prediction.html">Risk-Prediction</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="contents col-md-9">
<div id="oncocast-r-package" class="section level1">
<div class="page-header"><h1 class="hasAnchor">
<a href="#oncocast-r-package" class="anchor"></a><code>OncoCast</code> R package</h1></div>
<!-- badges: start -->

<div id="an-ensemble-learning-approach-for-outcome-prediction-in-precision-oncology-setting" class="section level2">
<h2 class="hasAnchor">
<a href="#an-ensemble-learning-approach-for-outcome-prediction-in-precision-oncology-setting" class="anchor"></a>An Ensemble Learning Approach for Outcome Prediction in Precision Oncology Setting</h2>
<p>Ensemble learner framework for survival outcome prediction and stratification for high dimension data. Originally developed for cancer genomics with delayed entry in the risk set in mind, and thus can adjust for left-truncation. OncoCast enables users to easily perform one or multiple machine learning survival analyses at once and explore and visualize the resulting output.</p>
</div>
<div id="installing-oncocast" class="section level2">
<h2 class="hasAnchor">
<a href="#installing-oncocast" class="anchor"></a>Installing <code>OncoCast</code>
</h2>
<p><code>OncoCast</code> has some dependencies that will be installed if they are not found in your library. When installing from github a prompt in the console may ask if you want to install the binaries for curl v4.0 instead of 3.3. There is no need to update it for the package to work properly.</p>
<div class="sourceCode" id="cb1"><pre class="r"><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span>(<span class="st">"devtools"</span>)
<span class="kw pkg">devtools</span><span class="kw ns">::</span><span class="fu"><a href="https://devtools.r-lib.org//reference/remote-reexports.html">install_github</a></span>(<span class="st">"AxelitoMartin/OncoCast"</span>)</pre></div>
<p>If you wish to use the development version of the package please use:</p>
<div class="sourceCode" id="cb2"><pre class="r"><span class="kw pkg">devtools</span><span class="kw ns">::</span><span class="fu"><a href="https://devtools.r-lib.org//reference/remote-reexports.html">install_github</a></span>(<span class="st">"AxelitoMartin/OncoCast"</span>, <span class="kw">ref</span> <span class="kw">=</span> <span class="st">"development"</span>)</pre></div>
</div>
<div id="using-oncocast" class="section level2">
<h2 class="hasAnchor">
<a href="#using-oncocast" class="anchor"></a>Using <code>OncoCast</code>
</h2>
<p>We recommend users to walk through the companion website to this package before their first use of the method. They will be guided through:</p>
<ul>
<li>
<a href="https://axelitomartin.github.io/OncoCast/articles/OncoCast-Data.html"><strong>Generating data in a ready for analysis format</strong></a> where the users will be guided on how to format their data to use <code>OncoCast</code>.</li>
<li>
<a href="https://axelitomartin.github.io/OncoCast/articles/Ensemble-Learner.html"><strong>Performing an ensemble learning run</strong></a> through a guide of the different machine learning algorithms available and how to create an ensemble model.</li>
<li>
<a href="https://axelitomartin.github.io/OncoCast/articles/Risk-Prediction.html"><strong>Generating comprehensible results</strong></a> with a tutorial on how to explore the predicted risk score of patients in the dataset, the prognostic power of the ensemble model, the importance of each feature of interest and how to optimize creation of risk groups in clinically meaningful subsets.</li>
<li>
<a href="https://axelitomartin.github.io/OncoCast/articles/Online-Tools.html"><strong>Using web-based interactive applications</strong></a> to simplify the exploration of results and sharing them collaborators.</li>
</ul>
</div>
<div id="oncocast-online" class="section level2">
<h2 class="hasAnchor">
<a href="#oncocast-online" class="anchor"></a><code>OncoCast</code> Online</h2>
<p>There exist a version of OncoCast completely web-based requiring no coding skills and minimal inputs to create and explore an ensemble model. It can be found through this <a href="https://axelitomartin.shinyapps.io/OncoCast/?_ga=2.133036616.733046146.1606492754-1896886074.1572897510"><strong>online RShiny application</strong></a>. The user will only be asked to input the dataset they wish to study and the method they want to use to create the emsemble model.</p>
</div>
<div id="introductory-example" class="section level2">
<h2 class="hasAnchor">
<a href="#introductory-example" class="anchor"></a>Introductory example</h2>
<p>Here we show a simple example of OncoCastâ€™s capacities utilizing an internal dataset. First constructing the ensemble model using for simplicity the LASSO method:</p>
<div class="sourceCode" id="cb3"><pre class="r"><span class="no">onco_run</span> <span class="kw">&lt;-</span> <span class="fu"><a href="reference/OncoCast.html">OncoCast</a></span>(<span class="kw">data</span> <span class="kw">=</span> <span class="no">survData</span>, <span class="kw">family</span> <span class="kw">=</span> <span class="st">"cox"</span>, <span class="kw">formula</span> <span class="kw">=</span> <span class="fu">Surv</span>(<span class="no">time</span>,<span class="no">status</span>)~<span class="no">.</span>, <span class="kw">method</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"LASSO"</span>),
                     <span class="kw">runs</span> <span class="kw">=</span> <span class="fl">50</span>, <span class="kw">cores</span> <span class="kw">=</span> <span class="fl">1</span>, <span class="kw">save</span> <span class="kw">=</span> <span class="fl">FALSE</span>
)
<span class="co">#&gt; [1] "Data check performed, ready for analysis."</span>
<span class="co">#&gt; [1] "LASSO SELECTED"</span></pre></div>
<p>The output of the <a href="https://axelitomartin.github.io/OncoCast/reference/OncoCast.html"><code><a href="reference/OncoCast.html">OncoCast()</a></code></a> function can used directly in the <a href="https://axelitomartin.github.io/OncoCast/reference/getResults_OC.html"><code><a href="reference/getResults_OC.html">getResults_OC()</a></code></a> function to create a set of comprehensible results to be explored.</p>
<div class="sourceCode" id="cb4"><pre class="r"><span class="no">results</span> <span class="kw">&lt;-</span> <span class="fu"><a href="reference/getResults_OC.html">getResults_OC</a></span>(<span class="kw">OC_object</span> <span class="kw">=</span> <span class="no">onco_run</span>$<span class="no">LASSO</span>, <span class="kw">data</span> <span class="kw">=</span> <span class="no">survData</span>)
<span class="co">#&gt; Warning: Vectorized input to `element_text()` is not officially supported.</span>
<span class="co">#&gt; Results may be unexpected or may change in future versions of ggplot2.</span></pre></div>
<p>This will generate the average predicted risk score for each patient in the dataset, while automatically creating risk groups through Kmeans clustering using a penalty:</p>
<div class="sourceCode" id="cb5"><pre class="r"><span class="fu">kable</span>(<span class="no">results</span>$<span class="no">RiskScoreSummary</span>)</pre></div>
<table class="table">
<thead><tr class="header">
<th align="left"></th>
<th align="right">Lower 10%</th>
<th align="right">1st Quarter</th>
<th align="right">1st Tertile</th>
<th align="right">Median</th>
<th align="right">2nd Tertile</th>
<th align="right">3rd Quarter</th>
<th align="right">Upper 10%</th>
</tr></thead>
<tbody><tr class="odd">
<td align="left">Risk Score</td>
<td align="right">2.64</td>
<td align="right">4.04</td>
<td align="right">4.39</td>
<td align="right">5.58</td>
<td align="right">6.08</td>
<td align="right">6.25</td>
<td align="right">7.75</td>
</tr></tbody>
</table>
<div class="sourceCode" id="cb6"><pre class="r"><span class="no">results</span>$<span class="no">RiskHistogram</span></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-4-1.png" width="100%"></p>
<p>In order to assess the prognostic performance of the ensemble model we record the concordance probability index found at each iteration:</p>
<div class="sourceCode" id="cb7"><pre class="r"><span class="fu">kable</span>(<span class="no">results</span>$<span class="no">CPE</span>)</pre></div>
<table class="table">
<thead><tr class="header">
<th align="left"></th>
<th align="right">Lower 10%</th>
<th align="right">1st Quarter</th>
<th align="right">Median</th>
<th align="right">3rd Quarter</th>
<th align="right">Upper 10%</th>
</tr></thead>
<tbody><tr class="odd">
<td align="left">Concordance probability estimate</td>
<td align="right">0.73</td>
<td align="right">0.74</td>
<td align="right">0.75</td>
<td align="right">0.77</td>
<td align="right">0.78</td>
</tr></tbody>
</table>
<p>Along with the average predicted risk score of each patients we can use as a predictor to refit a Cox proportional hazard model:</p>
<div class="sourceCode" id="cb8"><pre class="r"><span class="fu">kable</span>(<span class="no">results</span>$<span class="no">RiskRefitTable</span>)</pre></div>
<table class="table">
<thead><tr class="header">
<th align="left"></th>
<th align="right">Coefficient</th>
<th align="right">HazardRatio</th>
<th align="right">SE</th>
<th align="right">Z</th>
<th align="right">Pvalue</th>
</tr></thead>
<tbody><tr class="odd">
<td align="left">RiskScore</td>
<td align="right">0.6701482</td>
<td align="right">1.954527</td>
<td align="right">0.055481</td>
<td align="right">12.07888</td>
<td align="right">0</td>
</tr></tbody>
</table>
<p>Another metric of interest is the variable importance that we report using a variety of interactive plots, for the penalized regression methods such as LASSO (used here) we report this variable importance in the shape of a volcano plot. We show here a static version of it due to issue with README files:</p>
<div class="sourceCode" id="cb9"><pre class="r"><span class="no">mod_data</span> <span class="kw">&lt;-</span> <span class="no">results</span>$<span class="no">resultsAll</span> <span class="kw">%&gt;%</span>
  <span class="fu">mutate</span>(<span class="kw">Feature</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span>(<span class="no">results</span>$<span class="no">resultsAll</span>))

<span class="no">mod_data</span> <span class="kw">%&gt;%</span>
  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="kw">x</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span>(<span class="no">MeanCoefficient</span>), <span class="kw">y</span> <span class="kw">=</span> <span class="no">SelectionFrequency</span>, <span class="kw">label</span> <span class="kw">=</span> <span class="no">Feature</span>)) +
  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="kw">color</span> <span class="kw">=</span> <span class="no">.data</span>$<span class="no">SelectionFrequency</span> <span class="kw">&gt;</span> <span class="fl">0.8</span>), <span class="kw">show.legend</span> <span class="kw">=</span> <span class="fl">FALSE</span>) +
  <span class="fu">geom_text_repel</span>(<span class="kw">data</span> <span class="kw">=</span> <span class="no">mod_data</span> <span class="kw">%&gt;%</span>
              <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span>(<span class="no">SelectionFrequency</span> <span class="kw">&gt;</span> <span class="fl">0.8</span>) ) +
  <span class="fu">geom_vline</span>(<span class="kw">xintercept</span> <span class="kw">=</span> <span class="fl">1</span>, <span class="kw">linetype</span> <span class="kw">=</span> <span class="st">"dashed"</span>) +
  <span class="fu">geom_hline</span>(<span class="kw">yintercept</span> <span class="kw">=</span> <span class="fl">0.8</span>, <span class="kw">linetype</span> <span class="kw">=</span> <span class="st">"dashed"</span>, <span class="kw">color</span> <span class="kw">=</span> <span class="st">"blue"</span>) +
  <span class="fu">theme</span>(<span class="kw">legend.position</span> <span class="kw">=</span> <span class="st">"none"</span>) +
  <span class="fu">xlab</span>(<span class="st">"Mean hazard ratio"</span>) + <span class="fu">ylab</span>(<span class="st">"Selection Frequency"</span>) +
  <span class="fu">theme_bw</span>()</pre></div>
<p><img src="reference/figures/README-unnamed-chunk-7-1.png" width="100%"></p>
<p>Please refer to the <a href="https://axelitomartin.github.io/OncoCast/articles/Risk-Prediction.html"><strong>Risk_Prediction</strong></a> tab on the packageâ€™s website to see the interactive version.</p>
<p>We also create heatmaps sorted by predicted risk (left is low risk, right is high risk) to explore the distribution of features as a function of risk score:</p>
<div class="sourceCode" id="cb10"><pre class="r"><span class="no">results</span>$<span class="no">heatmap.sorted.bin</span></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-8-1.png" width="100%"></p>
<p>Finally we show the resulting stratification from the cuts performed above through a Kaplan-Meier plot along with a summary table to ease interpretation:</p>
<div class="sourceCode" id="cb11"><pre class="r"><span class="no">results</span>$<span class="no">KM</span></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-9-1.png" width="100%"></p>
<div class="sourceCode" id="cb12"><pre class="r"><span class="fu">kable</span>(<span class="no">results</span>$<span class="no">survivalTable</span>)</pre></div>
<table class="table">
<thead><tr class="header">
<th align="left"></th>
<th align="left">MedianOS</th>
<th align="left">95%CI</th>
<th align="left">1Ysurvival</th>
<th align="left">3Ysurvival</th>
<th align="left">HazardRatio</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">riskGroup 1</td>
<td align="left">NA</td>
<td align="left">(28.05,NA)</td>
<td align="left">0.9 (0.74,0.96)</td>
<td align="left">0.6 (0.3,0.8)</td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left">riskGroup 2</td>
<td align="left">22.62</td>
<td align="left">(18.95,31.68)</td>
<td align="left">0.78 (0.67,0.86)</td>
<td align="left">0.27 (0.13,0.44)</td>
<td align="left">2.875</td>
</tr>
<tr class="odd">
<td align="left">riskGroup 3</td>
<td align="left">6.9</td>
<td align="left">(4.39,10.94)</td>
<td align="left">0.35 (0.25,0.45)</td>
<td align="left">0.07 (0.02,0.15)</td>
<td align="left">9.351</td>
</tr>
<tr class="even">
<td align="left">riskGroup 4</td>
<td align="left">1.21</td>
<td align="left">(0.65,1.49)</td>
<td align="left">0.02 (0,0.11)</td>
<td align="left">0.02 (0,0.11)</td>
<td align="left">41.316</td>
</tr>
</tbody>
</table>
<p>We also include tools to perform validation and individual patient survival predictions, please refer to the <a href="https://axelitomartin.github.io/OncoCast/articles/Risk-Prediction.html"><strong>Risk_Prediction</strong></a> tab on the packageâ€™s website for more information on those topics.</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="license">
<h2>License</h2>
<ul class="list-unstyled">
<li>
<a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a>
</li>
</ul>
</div>
<div class="developers">
<h2>Developers</h2>
<ul class="list-unstyled">
<li>Axel Martin <br><small class="roles"> Maintainer </small>  </li>
</ul>
</div>

  <div class="dev-status">
<h2>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://travis-ci.org/AxelitoMartin/OncoCast"><img src="https://travis-ci.com/AxelitoMartin/OncoCast.svg?branch=development" alt="Travis build status"></a></li>
<li><a href="https://codecov.io/gh/AxelitoMartin/OncoCast?branch=development"><img src="https://codecov.io/gh/AxelitoMartin/OncoCast/branch/development/graph/badge.svg" alt="Codecov test coverage"></a></li>
<li><a href="https://zenodo.org/badge/latestdoi/211392347"><img src="https://zenodo.org/badge/211392347.svg" alt="DOI"></a></li>
</ul>
</div>
</div>
</div>


      <footer><div class="copyright">
  <p>Developed by Axel Martin.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
